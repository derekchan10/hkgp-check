# 中签结果比对工具

一个简单的Web应用，用于比对账号信息与中签结果。

## 功能特点

- 上传账号文件和中签结果文件进行自动比对
- 支持Excel格式（.xlsx, .xls）的文件
- 自动提取账号后三位
- 自动提取姓名的前5个英文字母
- **显示所有账号信息，未匹配的标记为"未匹配"**
- **实时显示匹配数量和未匹配数量统计**
- 友好的用户界面，展示比对结果
- 支持结果导出为CSV格式

## 文件要求

1. **账号文件**：包含两列数据
   - 第一列：姓名（中文或英文）
   - 第二列：账号

2. **中签结果文件**：包含四列数据
   - 第一列：账号后三位
   - 第二列：名字头5个字母
   - 第三列：投注数
   - 第四列：中签数

## 匹配逻辑

- **账号匹配**：提取账号后三位进行精确匹配
- **姓名匹配**：智能处理中英文姓名
  - 英文姓名：提取前N个字母（自动检测长度）
  - 中文姓名：转换为拼音后提取前N个字母
- **状态标记**：
  - ✅ 已匹配：显示投注数和中签数
  - ❌ 未匹配：投注数和中签数显示为"-"

## 安装与运行

### 环境要求

- Python 3.7+
- 安装依赖：`pip install -r requirements.txt`

### 启动应用

```bash
python app.py
```

访问 http://127.0.0.1:5000 即可使用。

## 使用方法

1. 上传账号文件（可选，如不上传则使用当前目录下的`account.xlsx`）
2. 上传中签结果文件（可选，如不上传则使用当前目录下的`result.xlsx`）
3. 点击"开始比对"按钮
4. 查看比对结果，包括：
   - 所有账号的匹配状态
   - 匹配数量和未匹配数量统计
   - 总中签数统计
5. 下载CSV格式的完整结果

## 示例文件

项目包含示例Excel文件：
- `account.xlsx`：示例账号文件
- `result.xlsx`：示例中签结果文件

可以用这些文件测试应用功能。 